<!DOCTYPE html>
<!-- saved from url=(0022)http://localhost:7738/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>movies_data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./movies_data_files/clipboard.min.js.download"></script>
<script src="./movies_data_files/quarto.js.download"></script>
<script src="./movies_data_files/popper.min.js.download"></script>
<script src="./movies_data_files/tippy.umd.min.js.download"></script>
<script src="./movies_data_files/anchor.min.js.download"></script>
<link href="./movies_data_files/tippy.css" rel="stylesheet">
<link href="./movies_data_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./movies_data_files/bootstrap.min.js.download"></script>
<link href="./movies_data_files/bootstrap-icons.css" rel="stylesheet">
<link href="./movies_data_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light" data-new-gr-c-s-check-loaded="14.1207.0" data-gr-ext-installed="">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<p>install.packages(“dplyr”) install.packages(“tidyr”) install.packages(“lubridate”) install.packages(“ggplot2”) install.packages(“corrplot”)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="http://localhost:7738/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="http://localhost:7738/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="http://localhost:7738/#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="http://localhost:7738/#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="http://localhost:7738/#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
</div>
<p>Working with movies data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="http://localhost:7738/#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importing data into movie_df dataframe </span></span>
<span id="cb15-2"><a href="http://localhost:7738/#cb15-2" aria-hidden="true" tabindex="-1"></a>movie_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Movies.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="http://localhost:7738/#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the first five rows</span></span>
<span id="cb16-2"><a href="http://localhost:7738/#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(movie_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Color          Director Reviews Duration Director_facebook_likes
1 Color     James Cameron     723      178                       0
2 Color    Gore Verbinski     302      169                     563
3 Color        Sam Mendes     602      148                       0
4 Color Christopher Nolan     813      164                   22000
5 Color    Andrew Stanton     462      132                     475
6 Color         Sam Raimi     392      156                       0
  Actor_3_facebook_likes     Actor_2_name Actor_1_facebook_likes     Gross
1                    855 Joel David Moore                   1000 760505847
2                   1000    Orlando Bloom                  40000 309404152
3                    161     Rory Kinnear                  11000 200074175
4                  23000   Christian Bale                  27000 448130642
5                    530  Samantha Morton                    640  73058679
6                   4000     James Franco                  24000 336530303
   Genre    Actor_1_name                                     Title   Votes
1 Action     CCH Pounder                                   Avatara  886204
2 Action     Johnny Depp Pirates of the Caribbean: At World's Enda  471220
3 Action Christoph Waltz                                  Spectrea  275868
4 Action       Tom Hardy                    The Dark Knight Risesa 1144337
5 Action    Daryl Sabara                              John Cartera  212204
6 Action    J.K. Simmons                             Spider-Man 3a  383056
  Cast_total_facebook_likes         Actor_3_name Facenumber_in_poster
1                      2791            Wes Studi                    0
2                     46563       Jack Davenport                    0
3                     11554     Stephanie Sigman                    1
4                     95000 Joseph Gordon-Levitt                    0
5                      2277         Polly Walker                    1
6                     39000        Kirsten Dunst                    0
                                                     Plot_keywords
1                           avatar|future|marine|native|paraplegic
2     goddess|marriage ceremony|marriage proposal|pirate|singapore
3                              bomb|espionage|sequel|spy|terrorist
4 deception|imprisonment|lawlessness|police officer|terrorist plot
5               alien|american civil war|male nipple|mars|princess
6                        sandman|spider man|symbiote|venom|villain
                                       Movie_imdb_link Language Content_rating
1 http://www.imdb.com/title/tt0499549/?ref_=fn_tt_tt_1  English          PG-13
2 http://www.imdb.com/title/tt0449088/?ref_=fn_tt_tt_1  English               
3 http://www.imdb.com/title/tt2379713/?ref_=fn_tt_tt_1  English          PG-13
4 http://www.imdb.com/title/tt1345836/?ref_=fn_tt_tt_1  English          PG-13
5 http://www.imdb.com/title/tt0401729/?ref_=fn_tt_tt_1  English          PG-13
6 http://www.imdb.com/title/tt0413300/?ref_=fn_tt_tt_1  English          PG-13
     Budget Year Actor_2_facebook_likes Imdb_score Aspect_ratio
1 237000000 2009                    936        7.9         1.78
2 300000000 2007                   5000        7.1         2.35
3 245000000 2015                    393        6.8         2.35
4 250000000 2012                  23000        8.5         2.35
5 263700000 2012                    632        6.6         2.35
6 258000000 2007                  11000        6.2         2.35
  Movie_facebook_likes
1                33000
2                    0
3                85000
4               164000
5                24000
6                    0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="http://localhost:7738/#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the dimension of dataframe</span></span>
<span id="cb18-2"><a href="http://localhost:7738/#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(movie_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3891   26</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="http://localhost:7738/#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for structure of each attribute</span></span>
<span id="cb20-2"><a href="http://localhost:7738/#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(movie_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3891 obs. of  26 variables:
 $ Color                    : chr  "Color" "Color" "Color" "Color" ...
 $ Director                 : chr  "James Cameron" "Gore Verbinski" "Sam Mendes" "Christopher Nolan" ...
 $ Reviews                  : int  723 302 602 813 462 392 324 635 375 673 ...
 $ Duration                 : int  178 169 148 164 132 156 100 141 153 183 ...
 $ Director_facebook_likes  : int  0 563 0 22000 475 0 15 0 282 0 ...
 $ Actor_3_facebook_likes   : int  855 1000 161 23000 530 4000 284 19000 10000 2000 ...
 $ Actor_2_name             : chr  "Joel David Moore" "Orlando Bloom" "Rory Kinnear" "Christian Bale" ...
 $ Actor_1_facebook_likes   : int  1000 40000 11000 27000 640 24000 799 26000 25000 15000 ...
 $ Gross                    : int  760505847 309404152 200074175 448130642 73058679 336530303 200807262 458991599 301956980 330249062 ...
 $ Genre                    : chr  "Action" "Action" "Action" "Action" ...
 $ Actor_1_name             : chr  "CCH Pounder" "Johnny Depp" "Christoph Waltz" "Tom Hardy" ...
 $ Title                    : chr  "Avatara" "Pirates of the Caribbean: At World's Enda" "Spectrea" "The Dark Knight Risesa" ...
 $ Votes                    : int  886204 471220 275868 1144337 212204 383056 294810 462669 321795 371639 ...
 $ Cast_total_facebook_likes: int  2791 46563 11554 95000 2277 39000 1651 66000 46282 21000 ...
 $ Actor_3_name             : chr  "Wes Studi" "Jack Davenport" "Stephanie Sigman" "Joseph Gordon-Levitt" ...
 $ Facenumber_in_poster     : int  0 0 1 0 1 0 1 4 3 0 ...
 $ Plot_keywords            : chr  "avatar|future|marine|native|paraplegic" "goddess|marriage ceremony|marriage proposal|pirate|singapore" "bomb|espionage|sequel|spy|terrorist" "deception|imprisonment|lawlessness|police officer|terrorist plot" ...
 $ Movie_imdb_link          : chr  "http://www.imdb.com/title/tt0499549/?ref_=fn_tt_tt_1" "http://www.imdb.com/title/tt0449088/?ref_=fn_tt_tt_1" "http://www.imdb.com/title/tt2379713/?ref_=fn_tt_tt_1" "http://www.imdb.com/title/tt1345836/?ref_=fn_tt_tt_1" ...
 $ Language                 : chr  "English" "English" "English" "English" ...
 $ Content_rating           : chr  "PG-13" "" "PG-13" "PG-13" ...
 $ Budget                   : num  2.37e+08 3.00e+08 2.45e+08 2.50e+08 2.64e+08 ...
 $ Year                     : int  2009 2007 2015 2012 2012 2007 2010 2015 2009 2016 ...
 $ Actor_2_facebook_likes   : int  936 5000 393 23000 632 11000 553 21000 11000 4000 ...
 $ Imdb_score               : num  7.9 7.1 6.8 8.5 6.6 6.2 7.8 7.5 7.5 6.9 ...
 $ Aspect_ratio             : num  1.78 2.35 2.35 2.35 2.35 2.35 1.85 2.35 2.35 2.35 ...
 $ Movie_facebook_likes     : int  33000 0 85000 164000 24000 0 29000 118000 10000 197000 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="http://localhost:7738/#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for na values</span></span>
<span id="cb22-2"><a href="http://localhost:7738/#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(movie_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="http://localhost:7738/#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Total number of na in dataframe</span></span>
<span id="cb24-2"><a href="http://localhost:7738/#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(movie_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="http://localhost:7738/#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exploring the summary of movie_df</span></span>
<span id="cb26-2"><a href="http://localhost:7738/#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(movie_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Color             Director            Reviews          Duration    
 Length:3891        Length:3891        Min.   :  1.00   Min.   : 34.0  
 Class :character   Class :character   1st Qu.: 72.25   1st Qu.: 95.0  
 Mode  :character   Mode  :character   Median :134.00   Median :106.0  
                                       Mean   :163.23   Mean   :109.9  
                                       3rd Qu.:221.75   3rd Qu.:120.0  
                                       Max.   :813.00   Max.   :330.0  
                                       NA's   :1        NA's   :1      
 Director_facebook_likes Actor_3_facebook_likes Actor_2_name      
 Min.   :    0.0         Min.   :    0.0        Length:3891       
 1st Qu.:   10.0         1st Qu.:  183.0        Class :character  
 Median :   58.0         Median :  427.0        Mode  :character  
 Mean   :  781.3         Mean   :  753.5                          
 3rd Qu.:  226.0         3rd Qu.:  687.0                          
 Max.   :23000.0         Max.   :23000.0                          
                         NA's   :10                               
 Actor_1_facebook_likes     Gross              Genre          
 Min.   :     0.0       Min.   :      162   Length:3891       
 1st Qu.:   721.8       1st Qu.:  6836508   Class :character  
 Median :  1000.0       Median : 27979400   Mode  :character  
 Mean   :  7584.7       Mean   : 51054995                     
 3rd Qu.: 12000.0       3rd Qu.: 65360661                     
 Max.   :640000.0       Max.   :760505847                     
 NA's   :3                                                    
 Actor_1_name          Title               Votes        
 Length:3891        Length:3891        Min.   :      5  
 Class :character   Class :character   1st Qu.:  17314  
 Mode  :character   Mode  :character   Median :  50415  
                                       Mean   : 102583  
                                       3rd Qu.: 124204  
                                       Max.   :1689764  
                                                        
 Cast_total_facebook_likes Actor_3_name       Facenumber_in_poster
 Min.   :     0            Length:3891        Min.   : 0.00       
 1st Qu.:  1580            Class :character   1st Qu.: 0.00       
 Median :  2886            Mode  :character   Median : 1.00       
 Mean   : 11080                               Mean   : 1.38       
 3rd Qu.: 15672                               3rd Qu.: 2.00       
 Max.   :655285                               Max.   :43.00       
                                              NA's   :6           
 Plot_keywords      Movie_imdb_link      Language         Content_rating    
 Length:3891        Length:3891        Length:3891        Length:3891       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     Budget               Year      Actor_2_facebook_likes   Imdb_score   
 Min.   :2.180e+02   Min.   :1920   Min.   :     0         Min.   :1.600  
 1st Qu.:1.000e+07   1st Qu.:1999   1st Qu.:   363         1st Qu.:5.900  
 Median :2.400e+07   Median :2005   Median :   664         Median :6.600  
 Mean   :4.521e+07   Mean   :2003   Mean   :  1971         Mean   :6.464  
 3rd Qu.:5.000e+07   3rd Qu.:2010   3rd Qu.:   971         3rd Qu.:7.200  
 Max.   :1.222e+10   Max.   :2016   Max.   :137000         Max.   :9.300  
                                    NA's   :5                             
  Aspect_ratio   Movie_facebook_likes
 Min.   : 1.18   Min.   :     0      
 1st Qu.: 1.85   1st Qu.:     0      
 Median : 2.35   Median :   209      
 Mean   : 2.11   Mean   :  9138      
 3rd Qu.: 2.35   3rd Qu.: 11000      
 Max.   :16.00   Max.   :349000      
 NA's   :75                          </code></pre>
</div>
</div>
<ol type="a">
<li>Dealing with missing values</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="http://localhost:7738/#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking each columns for missing values</span></span>
<span id="cb28-2"><a href="http://localhost:7738/#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(movie_df, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">which</span>(x<span class="sc">==</span><span class="st">""</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Color                  Director                   Reviews 
                        2                         0                         0 
                 Duration   Director_facebook_likes    Actor_3_facebook_likes 
                        0                         0                         0 
             Actor_2_name    Actor_1_facebook_likes                     Gross 
                        5                         0                         0 
                    Genre              Actor_1_name                     Title 
                        0                         3                         0 
                    Votes Cast_total_facebook_likes              Actor_3_name 
                        0                         0                        10 
     Facenumber_in_poster             Plot_keywords           Movie_imdb_link 
                        0                        31                         0 
                 Language            Content_rating                    Budget 
                        0                        74                         0 
                     Year    Actor_2_facebook_likes                Imdb_score 
                        0                         0                         0 
             Aspect_ratio      Movie_facebook_likes 
                        0                         0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="http://localhost:7738/#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets create a function to extract dimension  for each missing values</span></span>
<span id="cb30-2"><a href="http://localhost:7738/#cb30-2" aria-hidden="true" tabindex="-1"></a>missing_index <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">which</span>(x<span class="sc">==</span><span class="st">""</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-3"><a href="http://localhost:7738/#cb30-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">missing_index</span>(movie_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="http://localhost:7738/#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replacing all missing values with NA</span></span>
<span id="cb31-2"><a href="http://localhost:7738/#cb31-2" aria-hidden="true" tabindex="-1"></a>movie_df[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="http://localhost:7738/#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets verify for any missing values</span></span>
<span id="cb32-2"><a href="http://localhost:7738/#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(movie_df, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">which</span>(x<span class="sc">==</span><span class="st">""</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Color                  Director                   Reviews 
                        0                         0                         0 
                 Duration   Director_facebook_likes    Actor_3_facebook_likes 
                        0                         0                         0 
             Actor_2_name    Actor_1_facebook_likes                     Gross 
                        0                         0                         0 
                    Genre              Actor_1_name                     Title 
                        0                         0                         0 
                    Votes Cast_total_facebook_likes              Actor_3_name 
                        0                         0                         0 
     Facenumber_in_poster             Plot_keywords           Movie_imdb_link 
                        0                         0                         0 
                 Language            Content_rating                    Budget 
                        0                         0                         0 
                     Year    Actor_2_facebook_likes                Imdb_score 
                        0                         0                         0 
             Aspect_ratio      Movie_facebook_likes 
                        0                         0 </code></pre>
</div>
</div>
<p>Now that we have changed our missing value to NA, the total NA will increase in our dataframe. First lets explore the columns which have NA values again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="http://localhost:7738/#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(movie_df, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Color                  Director                   Reviews 
                        2                         0                         1 
                 Duration   Director_facebook_likes    Actor_3_facebook_likes 
                        1                         0                        10 
             Actor_2_name    Actor_1_facebook_likes                     Gross 
                        5                         3                         0 
                    Genre              Actor_1_name                     Title 
                        0                         3                         0 
                    Votes Cast_total_facebook_likes              Actor_3_name 
                        0                         0                        10 
     Facenumber_in_poster             Plot_keywords           Movie_imdb_link 
                        6                        31                         0 
                 Language            Content_rating                    Budget 
                        0                        74                         0 
                     Year    Actor_2_facebook_likes                Imdb_score 
                        0                         5                         0 
             Aspect_ratio      Movie_facebook_likes 
                       75                         0 </code></pre>
</div>
</div>
<p>Based on our dataset, I have decided to remove the following columns which have less influence on our target variable profit.</p>
<p>1.Title: Since we are interested in finding the influential factor for the profit and each movie has unique title. Hence the title may not be appropriate profit indicator in this case.</p>
<ol start="2" type="1">
<li><p>Color: Most of the value for Color attribute are color so this will provide less variability in our dataset.</p></li>
<li><p>Language: All the language value in our dataset are English, hence it can be less contributor to profit.</p></li>
<li><p>Year: Since this attribute is not a continuous variable and needs separate analysis using time series method, I am excluding this column in this analysis.</p></li>
<li><p>Plot_keywords: This attribute might not be relevant in deciding the profit.</p></li>
<li><p>Movie_imdb_link : This attribute might not be relevant in deciding the profit.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="http://localhost:7738/#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets create a dataframe without these columns</span></span>
<span id="cb36-2"><a href="http://localhost:7738/#cb36-2" aria-hidden="true" tabindex="-1"></a>m_df1 <span class="ot">&lt;-</span> <span class="fu">select</span>(movie_df,<span class="sc">-</span><span class="fu">c</span>(Title, Color, Language, Year, Movie_imdb_link,Plot_keywords ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since every movie has unique value for each attributes that cannot be assumed. If we impute these NA values using mode for categorical values and mean for numeric values then there is a chances that a particular movie could have high profit or rated high based on these value. Hence, I have decided to omit all the row which has NA value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="http://localhost:7738/#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets create a new data frame without NA value</span></span>
<span id="cb37-2"><a href="http://localhost:7738/#cb37-2" aria-hidden="true" tabindex="-1"></a>m_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(m_df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="http://localhost:7738/#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Verifying for no NA in dataset</span></span>
<span id="cb38-2"><a href="http://localhost:7738/#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(m_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Exploration part</li>
</ol>
<p>bi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="http://localhost:7738/#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets calculate the profit</span></span>
<span id="cb40-2"><a href="http://localhost:7738/#cb40-2" aria-hidden="true" tabindex="-1"></a>m_df<span class="sc">$</span>profit <span class="ot">&lt;-</span> m_df<span class="sc">$</span>Gross<span class="sc">-</span>m_df<span class="sc">$</span>Budget</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before plotting the data lets normalize our dataset to bring them to same scale of 0 to 1 using min-max scaler. This will make our data consistent and easy to visualize since all the value will be converge to same scale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="http://localhost:7738/#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining normalization function</span></span>
<span id="cb41-2"><a href="http://localhost:7738/#cb41-2" aria-hidden="true" tabindex="-1"></a>minmax_scale <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb41-3"><a href="http://localhost:7738/#cb41-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">-</span><span class="fu">min</span>(x))<span class="sc">/</span>(<span class="fu">max</span>(x)<span class="sc">-</span><span class="fu">min</span>(x))</span>
<span id="cb41-4"><a href="http://localhost:7738/#cb41-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since the normalization function cannot take categorical columns as argument we must have separate dataframe with numeric value only. First lets create a dataframe which consist of numeric value only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="http://localhost:7738/#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering column with numeric datatype from our dataset</span></span>
<span id="cb42-2"><a href="http://localhost:7738/#cb42-2" aria-hidden="true" tabindex="-1"></a>num_m_df <span class="ot">&lt;-</span> m_df[, <span class="fu">sapply</span>(m_df,is.numeric)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can call normalization function on our new dataframe num_m_df.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="http://localhost:7738/#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Normalized dataframe </span></span>
<span id="cb43-2"><a href="http://localhost:7738/#cb43-2" aria-hidden="true" tabindex="-1"></a>nor_m_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sapply</span>(num_m_df,minmax_scale))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we are ready to plot our data and see the relationship using regression line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="http://localhost:7738/#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot between profit and Imdb_score</span></span>
<span id="cb44-2"><a href="http://localhost:7738/#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nor_m_df, <span class="fu">aes</span>(<span class="at">y=</span>profit,<span class="at">x=</span>Imdb_score)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Profit by IMDB Score"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,  <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph we can see that there is weak correlation among Imdb_score and profit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="http://localhost:7738/#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot between profit and Gross</span></span>
<span id="cb46-2"><a href="http://localhost:7738/#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nor_m_df, <span class="fu">aes</span>(<span class="at">y=</span>profit,<span class="at">x=</span>Gross)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Profit by Gross Income"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,  <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph we can see that there is slight negative correlation among gross income and profit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="http://localhost:7738/#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot between profit and Reviews</span></span>
<span id="cb48-2"><a href="http://localhost:7738/#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nor_m_df, <span class="fu">aes</span>(<span class="at">y=</span>profit,<span class="at">x=</span>Reviews)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Profit by Reviews"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,  <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph we can see that there is weak correlation among review and profit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="http://localhost:7738/#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot between profit and Movie Facebook likes</span></span>
<span id="cb50-2"><a href="http://localhost:7738/#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nor_m_df, <span class="fu">aes</span>(<span class="at">y=</span>profit,<span class="at">x=</span>Movie_facebook_likes)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Profit by Movie Facebook likes"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,  <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph we can see that there is weak correlation among review and profit.</p>
<ol start="2" type="i">
<li>Correlation between the variables. Since our variables are mixed type(ordinal and nominal), I have used kendall method to calculate the correlation</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="http://localhost:7738/#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating the correlation between variables</span></span>
<span id="cb52-2"><a href="http://localhost:7738/#cb52-2" aria-hidden="true" tabindex="-1"></a>cor_d <span class="ot">&lt;-</span> <span class="fu">cor</span>(nor_m_df, <span class="at">method=</span><span class="st">"kendall"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="i">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="http://localhost:7738/#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets rename our columns to make our visualization better</span></span>
<span id="cb53-2"><a href="http://localhost:7738/#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cor_d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"reviews"</span>,<span class="st">"duration"</span>, <span class="st">"dir_fb_l"</span>,<span class="st">"act3_fb_l"</span>,<span class="st">"act1_fb_l"</span>,<span class="st">"gross"</span>,<span class="st">"votes"</span>,<span class="st">"cast_fb_l"</span>,<span class="st">"p_face_no"</span>,<span class="st">"budget"</span>,<span class="st">"act2_fb_l"</span>,<span class="st">"imdb_scr"</span>,<span class="st">"asp_r"</span>,<span class="st">"m_fb_l"</span>,<span class="st">"profit"</span>)</span>
<span id="cb53-3"><a href="http://localhost:7738/#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cor_d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"reviews"</span>,<span class="st">"duration"</span>, <span class="st">"dir_fb_l"</span>,<span class="st">"act3_fb_l"</span>,<span class="st">"act1_fb_l"</span>,<span class="st">"gross"</span>,<span class="st">"votes"</span>,<span class="st">"cast_fb_l"</span>,<span class="st">"p_face_no"</span>,<span class="st">"budget"</span>,<span class="st">"act2_fb_l"</span>,<span class="st">"imdb_scr"</span>,<span class="st">"asp_r"</span>,<span class="st">"m_fb_l"</span>,<span class="st">"profit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="http://localhost:7738/#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets make the copy of our correlation matrix</span></span>
<span id="cb54-2"><a href="http://localhost:7738/#cb54-2" aria-hidden="true" tabindex="-1"></a>cor_d1 <span class="ot">&lt;-</span> cor_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="http://localhost:7738/#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets set the diagonal correlation coefficient value to NA which is correlation with self.</span></span>
<span id="cb55-2"><a href="http://localhost:7738/#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(cor_d1) <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="http://localhost:7738/#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets change our matrix to dataframe</span></span>
<span id="cb56-2"><a href="http://localhost:7738/#cb56-2" aria-hidden="true" tabindex="-1"></a>cor_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cor_d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="http://localhost:7738/#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Listing the maximum positive correlation coefficient between profit and other variable</span></span>
<span id="cb57-2"><a href="http://localhost:7738/#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(cor_df<span class="sc">$</span>profit, <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4500739</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="http://localhost:7738/#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the index of this value</span></span>
<span id="cb59-2"><a href="http://localhost:7738/#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cor_df<span class="sc">==</span><span class="fu">max</span>(cor_df<span class="sc">$</span>profit, <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       row col
profit  15   6
gross    6  15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="http://localhost:7738/#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Listing maximum negative correlation</span></span>
<span id="cb61-2"><a href="http://localhost:7738/#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(cor_df<span class="sc">$</span>profit, <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1026907</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="http://localhost:7738/#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the index of this value</span></span>
<span id="cb63-2"><a href="http://localhost:7738/#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cor_df<span class="sc">==</span><span class="fu">min</span>(cor_df<span class="sc">$</span>profit, <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       row col
profit  15  10
budget  10  15</code></pre>
</div>
</div>
<p>Lets visualize our result in graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="http://localhost:7738/#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot between profit and Budget</span></span>
<span id="cb65-2"><a href="http://localhost:7738/#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nor_m_df, <span class="fu">aes</span>(<span class="at">y=</span>profit,<span class="at">x=</span>Gross)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Profit by Gross"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,  <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From above two result the maximum positive correlation is between profit and gross with the value of 0.45 and maximum negative correlation is between profit and budget with the value of -0.1.</p>
<p>It is obvious that higher the gross income of the movie higher the profit which is also shown by our result. Hence if we want to increase the profit we must explore the variables that have influence on the gross sales to name few Director, Actor1 etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="http://localhost:7738/#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Listing the minimum correlation</span></span>
<span id="cb67-2"><a href="http://localhost:7738/#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">abs</span>(cor_df<span class="sc">$</span>profit), <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004529327</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="http://localhost:7738/#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the index of this value</span></span>
<span id="cb69-2"><a href="http://localhost:7738/#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="http://localhost:7738/#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cor_df<span class="sc">==</span><span class="fu">min</span>(<span class="fu">abs</span>(cor_df<span class="sc">$</span>profit), <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         row col
profit    15   2
duration   2  15</code></pre>
</div>
</div>
<p>So the weakest correlation between profit is with duration of movie with the value of 0.0045.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="http://localhost:7738/#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets see a line graph between profit and duration</span></span>
<span id="cb71-2"><a href="http://localhost:7738/#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#scatter plot between profit and duration</span></span>
<span id="cb71-3"><a href="http://localhost:7738/#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nor_m_df, <span class="fu">aes</span>(<span class="at">y=</span>profit,<span class="at">x=</span>Duration)) <span class="sc">+</span> <span class="fu">geom_point</span>()<span class="sc">+</span>  <span class="fu">ggtitle</span>(<span class="st">"Profit by Duration"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,  <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above result we see that the duration of the movie has very less impact on the profit. This may be because most of the value lies below the range of 120 minutes which cause minimal effect on profit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="http://localhost:7738/#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_df<span class="sc">$</span>Duration)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   37.0    96.0   106.0   110.2   120.0   330.0 </code></pre>
</div>
</div>
<p>Lets plot the correlation coefficient for all the variable that we have used in our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="http://localhost:7738/#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation Matrix plot</span></span>
<span id="cb75-2"><a href="http://localhost:7738/#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_d,<span class="at">method=</span><span class="st">"number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="http://localhost:7738/#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets explore the value of maximum correlation coefficient in our study</span></span>
<span id="cb76-2"><a href="http://localhost:7738/#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(cor_df), <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8419219</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="http://localhost:7738/#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Index of maximum corelation</span></span>
<span id="cb78-2"><a href="http://localhost:7738/#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cor_df<span class="sc">==</span><span class="fu">max</span>(<span class="fu">abs</span>(cor_df), <span class="at">na.rm=</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          row col
cast_fb_l   8   5
act1_fb_l   5   8</code></pre>
</div>
</div>
<p>This value is for the cast_facebook_likes and actor1_facebook_likes. We can interpret this result as if a lead actor of the movie have higher facebook like than the overall cast of the movie will get higher likes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="http://localhost:7738/#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets explore the value of minimum correlation coefficient in our study</span></span>
<span id="cb80-2"><a href="http://localhost:7738/#cb80-2" aria-hidden="true" tabindex="-1"></a>min_correlation <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">abs</span>(cor_df), <span class="at">na.rm=</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-3"><a href="http://localhost:7738/#cb80-3" aria-hidden="true" tabindex="-1"></a>min_correlation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002067434</code></pre>
</div>
</div>
<p>If we search our correlation matrix this value matches -0.002067434 with number of faces on poster and movie likes on facebook. Hence we can say that there is very weak relation between Facebook like for a movie based on number of faces on poster.</p>
<p>We can also visualize our correlation result using corrplot with square method for better visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="http://localhost:7738/#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation Matrix plot</span></span>
<span id="cb82-2"><a href="http://localhost:7738/#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_d,<span class="at">method=</span><span class="st">"square"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./movies_data_files/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "D:\SMDS\CSE5DEV\assignment 2\Movies_data.Rmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "D:\SMDS\CSE5DEV\assignment 2\Movies_data.Rmd"
    }, "*");
  }
</script>
</body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>